{% extends 'subnetting.html' %}
{% import 'form.html' as my_form %}

{% block form %}
    {{ my_form.network_form(context.network, context.sizes) }}
{% endblock %}

{% block alert %}{% endblock %}

{% block network_info_panel_head %}Информация об исходной сети{% endblock %}
{% block network_info %}
    <div id="network-info" class="table-responsive">
        <table class="table table-bordered table-striped table-condensed">
            <tr>
                <th class="field-label col-md-4">
                    Cеть
                </th>
                <td class="col-md-8">{{ context.network.compressed }}</td>
            </tr>
            <tr>
                <th class="field-label col-md-4">
                    Количество доступных адресов
                </th>
                <td class="col-md-8">{{ context.network.num_addresses }}</td>
            </tr>
            <tr>
                <th class="field-label col-md-4">
                    Количество необходимых адресов
                </th>
                <td class="col-md-8">{{ context.sizes | sum }}</td>
            </tr>
            <tr>
                <th class="field-label col-md-4">
                    Количество использованных адресов
                </th>
                <td class="col-md-8">{{ context.dedicated }}</td>
            </tr>
            <tr>
                <th class="field-label col-md-4">
                    Количество свободных адресов
                </th>
                <td class="col-md-8">{{ context.network.num_addresses - context.dedicated }}</td>
            </tr>
            <tr>
                <th class="field-label col-md-4">
                    Коэфициент оптимального использования
                </th>
                <td class="col-md-8">
                    {{ 1 - (context.network.num_addresses - context.dedicated) / context.network.num_addresses }}
                </td>
            </tr>
        </table>
    </div>
{% endblock %}

{% block required_info_panel_head %}Информация о выделенных IP-адресов{% endblock %}
{% block required_info %}
    <div id="hosts" class="table-responsive">
        <table class="table table-bordered table-striped table-hover">
            <tr class="success">
                <th class="col-sm-1">Размер</th>
                <th class="col-sm-1">Выделенный размер</th>
                <th class="col-sm-2">Адрес</th>
                <th class="col-sm-1">Маска</th>
                <th class="col-sm-2">Десятичная маска</th>
                <th class="col-sm-2">Бродкаст</th>
                <th class="col-sm-3">Диапазон адресов</th>
            </tr>
            {% for size, network in context.networks %}
                <tr>
                    <td class="col-sm-1">{{ size }}</td>
                    <td class="col-sm-1">{{ network.num_addresses - 2 }}</td>
                    <td class="col-sm-2">{{ network.network_address }}</td>
                    <td class="col-sm-1">{{ network.prefixlen }}</td>
                    <td class="col-sm-2">{{ network.netmask }}</td>
                    <td class="col-sm-2">{{ network.broadcast_address }}</td>
                    <td class="col-sm-3">{{ network.network_address + 1 }} - {{ network.broadcast_address - 1 }}</td>
                </tr>
            {% endfor %}
        </table>
    </div>
{% endblock %}

{% block binary_network_panel_head %}Бинарная репрезентация {% endblock %}
{% block binary_network_info %}
    {% set version  = context.network.version %}
    <div id="network-info" class="table-responsive">
        <table class="table table-bordered table-striped table-condensed">
            <tr>
                <th>
                    =
                </th>
                <th>Десятичное представление</th>
                <th>Двоичное представление</th>
            </tr>
            <tr>
                <td class="field-label col-md-4">Адрес сети</td>
                <td class="col-md-4">{{ context.network.network_address.compressed }}</td>
                <td class="col-md-4"><code>{{ context.network.network_address | to_bit(version) }}</code></td>

            </tr>
            <tr>
                <td class="field-label col-md-4">Маска
                </td>
                <td class="col-md-4">{{ context.network.netmask }}</td>
                <td class="col-md-4"><code>{{ context.network.netmask | to_bit(version) }}</code></td>
            </tr>
            <tr>
                <td class="field-label col-md-4">
                    Маска хоста
                </td>
                <td class="col-md-4">{{ context.network.hostmask }}</td>
                <td class="col-md-4"><code>{{ context.network.hostmask | to_bit(version) }}</code></td>
            </tr>
            <tr>
                <td class="field-label col-md-4">Адрес бродкаста</td>
                <td class="col-md-4">{{ context.network.netmask }}</td>
                <td class="col-md-4"><code>{{ context.network.netmask | to_bit(version) }}</code></td>
            </tr>
        </table>
    </div>
{% endblock %}
